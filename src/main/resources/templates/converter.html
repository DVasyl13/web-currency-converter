<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <title>Currency Converter</title>
</head>
<body>
<div class="container mt-5" style="background-color: #E8E8E8; border-radius: 10px; height: 450px">
    <h1>Currency Converter</h1>
    <div class="form-group">
        <label for="amount">Amount:</label>
        <input type="number" class="form-control" id="amount" name="amount" required onchange="calculateResult()">
    </div>
    <div class="form-group">
        <label for="fromCurrency">From:</label>
        <select class="form-control" id="fromCurrency" name="fromCurrency" onchange="calculateResult()">
            <option value="USD">USD</option>
            <option value="EUR">EUR</option>
            <option value="GBP">GBP</option>
            <option value="JPY">JPY</option>
            <option value="UAH">UAH</option>
            <option value="PLN">PLN</option>
            <option value="AUD">AUD</option>
            <option value="CAD">CAD</option>
            <option value="CHF">CHF</option>
            <option value="CNY">CNY</option>
        </select>
    </div>
    <div class="form-group">
        <label for="toCurrency">To:</label>
        <select class="form-control" id="toCurrency" name="toCurrency" onchange="calculateResult()">
            <option value="USD">USD</option>
            <option value="EUR">EUR</option>
            <option value="GBP">GBP</option>
            <option value="JPY">JPY</option>
            <option value="UAH">UAH</option>
            <option value="PLN">PLN</option>
            <option value="AUD">AUD</option>
            <option value="CAD">CAD</option>
            <option value="CHF">CHF</option>
            <option value="CNY">CNY</option>
        </select>
    </div>
    <br>
    <div id="result">
        <h2>Result:</h2>
        <label id="calculation"></label>
    </div>
</div>
<script>
    let myMap = new Map();

    document.addEventListener("DOMContentLoaded", function() {
        fetch('http://localhost:8080/currency-rates')
            .then(response => response.json())
            .then(data => {
                myMap = new Map(Object.entries(data));
                console.log(myMap);
            })
            .catch(error => console.error(error));
    });

    function calculateResult() {
        var amount = document.getElementById("amount").value;
        var fromCurrency = document.getElementById("fromCurrency").value;
        var toCurrency = document.getElementById("toCurrency").value;
        // 500
        // 1 USD --- 36 UAH
        // => 500 * (36/1)

        // 1000
        // 3.67 AED --- 90 AFN
        // => 1000 * (90/3.67)
        var coef = myMap.get(toCurrency)/myMap.get(fromCurrency);
        var result = document.getElementById("calculation");

        result.innerHTML = String(coef * amount);
    }

</script>
</body>
</html>